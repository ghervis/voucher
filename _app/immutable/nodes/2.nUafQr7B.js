import"../chunks/NZTpNUN0.js";import"../chunks/CwkVU6ps.js";import{s as Xe,j,K as Kr,V as Xr,k as Qr,i as Wr,g as e,aj as Kt,l as Zr,m as eo,n as Gt,o as Qe,v as ge,X as to,$ as ro,p as Xt,q as Qt,t as oo,a2 as Wt,T as Zt,at as k,ay as zt,az as We,O as Bt,aA as ao,aB as no,aC as so,L as io,aD as lo,aE as co,aF as uo,aG as vo,Y as fo,w as ho,Q as mo,aH as po,aI as go,aJ as bo,aK as xo,aL as _o,aM as wo,b as z,x as yo,z as Co,aN as le,aO as ko,A as H,B as Ze,C as W,G as s,J as f,D,F as No,al as c,I as n,aP as Eo,aQ as Z,aR as Ao,ax as So,av as Vo,aS as Do,aT as $o}from"../chunks/C88vm6q9.js";import{l as er,a as To,o as Mo,e as L,r as Fo,s as P,b as Lo}from"../chunks/D4tB4DRY.js";import{b as Ho}from"../chunks/B-WwrAeT.js";import{i as G,b as Ee}from"../chunks/6g30B3Hu.js";import{i as Oo}from"../chunks/Bj_Ne2mG.js";function Ro(r,o){return o}function Io(r,o,i,d){for(var u=[],v=o.length,p=0;p<v;p++)so(o[p].e,u,!0);var b=v>0&&u.length===0&&i!==null;if(b){var O=i.parentNode;io(O),O.append(i),d.clear(),re(r,o[0].prev,o[v-1].next)}lo(u,()=>{for(var N=0;N<v;N++){var g=o[N];b||(d.delete(g.k),re(r,g.prev,g.next)),co(g.e,!b)}})}function Uo(r,o,i,d,u,v=null){var p=r,b={flags:o,items:new Map,first:null};{var O=r;p=j?Xe(Kr(O)):O.appendChild(Xr())}j&&Qr();var N=null,g=!1,I=Kt(()=>{var x=i();return Zt(x)?x:x==null?[]:Wt(x)});Wr(()=>{var x=e(I),_=x.length;if(g&&_===0)return;g=_===0;let w=!1;if(j){var m=Zr(p)===eo;m!==(_===0)&&(p=Gt(),Xe(p),Qe(!1),w=!0)}if(j){for(var Y=null,E,$=0;$<_;$++){if(ge.nodeType===to&&ge.data===ro){p=ge,w=!0,Qe(!1);break}var ee=x[$],V=d(ee,$);E=tr(ge,b,Y,null,ee,V,$,u,o,i),b.items.set(V,E),Y=E}_>0&&Xe(Gt())}j||qo(x,b,p,u,o,d,i),v!==null&&(_===0?N?Xt(N):N=Qt(()=>v(p)):N!==null&&oo(N,()=>{N=null})),w&&Qe(!0),e(I)}),j&&(p=ge)}function qo(r,o,i,d,u,v,p){var b=r.length,O=o.items,N=o.first,g=N,I,x=null,_=[],w=[],m,Y,E,$;for($=0;$<b;$+=1){if(m=r[$],Y=v(m,$),E=O.get(Y),E===void 0){var ee=g?g.e.nodes_start:i;x=tr(ee,o,x,x===null?o.first:x.next,m,Y,$,d,u,p),O.set(Y,x),_=[],w=[],g=x.next;continue}if(Go(E,m,$),(E.e.f&We)!==0&&Xt(E.e),E!==g){if(I!==void 0&&I.has(E)){if(_.length<w.length){var V=w[0],R;x=V.prev;var J=_[0],K=_[_.length-1];for(R=0;R<_.length;R+=1)Pt(_[R],V,i);for(R=0;R<w.length;R+=1)I.delete(w[R]);re(o,J.prev,K.next),re(o,x,J),re(o,K,V),g=V,x=K,$-=1,_=[],w=[]}else I.delete(E),Pt(E,g,i),re(o,E.prev,E.next),re(o,E,x===null?o.first:x.next),re(o,x,E),x=E;continue}for(_=[],w=[];g!==null&&g.k!==Y;)(g.e.f&We)===0&&(I??=new Set).add(g),w.push(g),g=g.next;if(g===null)continue;E=g}_.push(E),x=E,g=E.next}if(g!==null||I!==void 0){for(var X=I===void 0?[]:Wt(I);g!==null;)(g.e.f&We)===0&&X.push(g),g=g.next;var te=X.length;if(te>0){var Q=b===0?i:null;Io(o,X,Q,O)}}Bt.first=o.first&&o.first.e,Bt.last=x&&x.e}function Go(r,o,i,d){no(r.v,o),r.i=i}function tr(r,o,i,d,u,v,p,b,O,N){var g=(O&uo)!==0,I=(O&vo)===0,x=g?I?k(u,!1,!1):zt(u):u,_=(O&ao)===0?p:zt(p),w={i:_,v:x,k:v,a:null,e:null,prev:i,next:d};try{return w.e=Qt(()=>b(r,x,_,N),j),w.e.prev=i&&i.e,w.e.next=d&&d.e,i===null?o.first=w:(i.next=w,i.e.next=w.e),d!==null&&(d.prev=w,d.e.prev=w.e),w}finally{}}function Pt(r,o,i){for(var d=r.next?r.next.e.nodes_start:i,u=o?o.e.nodes_start:i,v=r.e.nodes_start;v!==d;){var p=fo(v);u.before(v),v=p}}function re(r,o,i){o===null?r.first=i:(o.next=i,o.e.next=i&&i.e),i!==null&&(i.prev=o,i.e.prev=o&&o.e)}function zo(r,o,i){var d=r==null?"":""+r;return d===""?null:d}function Bo(r,o){return r==null?null:String(r)}function jt(r,o,i,d,u,v){var p=r.__className;if(j||p!==i||p===void 0){var b=zo(i);(!j||b!==r.getAttribute("class"))&&(b==null?r.removeAttribute("class"):r.className=b),r.__className=i}return v}function Po(r,o,i,d){var u=r.__style;if(j||u!==o){var v=Bo(o);(!j||v!==r.getAttribute("style"))&&(v==null?r.removeAttribute("style"):r.style.cssText=v),r.__style=o}return d}function rr(r,o,i=!1){if(r.multiple){if(o==null)return;if(!Zt(o))return po();for(var d of r.options)d.selected=o.includes(be(d));return}for(d of r.options){var u=be(d);if(go(u,o)){d.selected=!0;return}}(!i||o!==void 0)&&(r.selectedIndex=-1)}function jo(r){var o=new MutationObserver(()=>{rr(r,r.__value)});o.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),mo(()=>{o.disconnect()})}function Jo(r,o,i=o){var d=!0;er(r,"change",u=>{var v=u?"[selected]":":checked",p;if(r.multiple)p=[].map.call(r.querySelectorAll(v),be);else{var b=r.querySelector(v)??r.querySelector("option:not([disabled])");p=b&&be(b)}i(p)}),ho(()=>{var u=o();if(rr(r,u,d),d&&u===void 0){var v=r.querySelector(":checked");v!==null&&(u=be(v),i(u))}r.__value=u,d=!1}),jo(r)}function be(r){return"__value"in r?r.__value:r.value}const Yo=Symbol("is custom element"),Ko=Symbol("is html");function Jt(r){if(j){var o=!1,i=()=>{if(!o){if(o=!0,r.hasAttribute("value")){var d=r.value;Yt(r,"value",null),r.value=d}if(r.hasAttribute("checked")){var u=r.checked;Yt(r,"checked",null),r.checked=u}}};r.__on_r=i,bo(i),To()}}function Yt(r,o,i,d){var u=Xo(r);j&&(u[o]=r.getAttribute(o),o==="src"||o==="srcset"||o==="href"&&r.nodeName==="LINK")||u[o]!==(u[o]=i)&&(o==="loading"&&(r[xo]=i),r.removeAttribute(o))}function Xo(r){return r.__attributes??={[Yo]:r.nodeName.includes("-"),[Ko]:r.namespaceURI===_o}}function et(r,o,i=o){var d=wo();er(r,"input",u=>{var v=u?r.defaultValue:r.value;if(v=tt(r)?rt(v):v,i(v),d&&v!==(v=o())){var p=r.selectionStart,b=r.selectionEnd;r.value=v??"",b!==null&&(r.selectionStart=p,r.selectionEnd=Math.min(b,r.value.length))}}),(j&&r.defaultValue!==r.value||z(o)==null&&r.value)&&i(tt(r)?rt(r.value):r.value),yo(()=>{var u=o();tt(r)&&u===rt(r.value)||r.type==="date"&&!u&&!r.value||u!==r.value&&(r.value=u??"")})}function tt(r){var o=r.type;return o==="number"||o==="range"}function rt(r){return r===""?null:+r}function Qo(r){return function(...o){var i=o[0];return i.preventDefault(),r?.apply(this,o)}}var Wo=H("<div> </div>"),Zo=H("<div> </div>"),ea=H("<div> </div>"),ta=H("<div> </div>"),ra=H('<div class="text-xs text-gray-600 mt-1 space-y-0.5"><!> <!> <!> <!></div>'),oa=Ao('<svg class="animate-spin h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),aa=H('<div class="fixed top-20 right-4 bg-green-600 text-white px-4 py-3 rounded-lg shadow-lg z-20 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <span class="text-sm font-medium"> </span></div>'),na=H('<div class="bg-red-50 border border-red-200 rounded-lg p-4 sm:p-6 mb-6 sm:mb-8 mx-2 sm:mx-0"><h3 class="text-red-800 font-semibold mb-2 text-sm sm:text-base">Error Loading Data</h3> <p class="text-red-600 mb-4 text-sm"> </p> <button class="w-full sm:w-auto px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors text-sm">Try Again</button></div>'),sa=H('<div class="absolute top-0 right-0 flex gap-2"><button class="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors text-sm shadow-sm" title="Edit voucher">Edit</button> <button class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors text-sm shadow-sm" title="Delete voucher">Delete</button></div>'),ia=H('<div class="absolute top-0 right-0 flex gap-2"><button class="px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors text-sm shadow-sm" title="Hide voucher">Hide</button></div>'),la=H('<div class="mt-3 relative"><details class="w-full"><summary class="cursor-pointer text-sm font-semibold text-gray-700 hover:text-gray-900 py-1"> </summary> <div class="mt-3 p-3 bg-white/95 rounded border border-white/60 text-sm space-y-2 shadow-sm"><div><p class="text-gray-600 mt-1 leading-relaxed"> </p></div></div></details> <!></div>'),ca=H('<div><div class="mb-3"><button title="Click to copy voucher code" aria-label="Copy voucher code"><span class="flex-1 text-left"> </span> <div class="flex items-center gap-2 ml-2 flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></div></button></div> <!></div>'),da=H('<div class="space-y-3 sm:space-y-4 mb-6 sm:mb-8"></div>'),ua=H('<div class="text-center py-8 bg-gray-50 rounded-lg border border-gray-200"><p class="text-gray-500 mb-2">No vouchers available</p> <p class="text-sm text-gray-400">Add a custom voucher or refresh to fetch GrabFood vouchers</p></div>'),va=H('<div class="text-center py-8"><div class="inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div> <p class="text-gray-600 mt-2 text-sm">Fetching more vouchers...</p></div>'),fa=H("<!> <!>",1),ha=H(`<div class="h-screen flex flex-col bg-cover bg-center bg-no-repeat"><div class="sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm"><div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4"><div class="flex flex-row items-start justify-between gap-4"><div class="flex-1"><h1 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900"> </h1> <!></div> <div class="flex flex-col gap-2 items-end flex-shrink-0"><button class="px-4 sm:px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium text-xs sm:text-sm whitespace-nowrap">Add Custom Voucher</button> <div class="flex gap-2"><button class="px-4 sm:px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-xs sm:text-sm whitespace-nowrap"><!></button> <button class="px-4 sm:px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors font-medium text-xs sm:text-sm whitespace-nowrap" title="Clear cache and fetch fresh data">Force</button></div></div></div></div></div> <div class="flex-1 overflow-y-auto"><div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8"><!> <!> <!></div></div></div> <dialog class="p-0 rounded-lg shadow-xl max-w-md svelte-1w11x2y" style="margin: 1rem auto; width: calc(100% - 2rem);"><div class="p-6"><div class="flex justify-between items-center mb-4"><h3 class="text-lg font-semibold text-purple-800"> </h3> <button class="text-gray-400 hover:text-gray-600 transition-colors" aria-label="Close modal"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="mb-4 p-2 bg-blue-50 border border-blue-200 rounded-lg"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="text-xs text-blue-700">Only you can see this addition.</p></div></div> <form class="space-y-4"><div><label for="modal-voucher-code" class="block text-sm font-medium text-gray-700 mb-1">Voucher Code *</label> <input id="modal-voucher-code" type="text" placeholder="Enter voucher code" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"/></div> <div><label for="modal-voucher-merchant" class="block text-sm font-medium text-gray-700 mb-1">Merchant *</label> <select id="modal-voucher-merchant" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"><option>GrabFood</option><option>Foodpanda</option></select></div> <div><label for="modal-voucher-cta" class="block text-sm font-medium text-gray-700 mb-1">Title *</label> <input id="modal-voucher-cta" type="text" placeholder="e.g., 'Save 20% on your order'" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div> <div><label for="modal-voucher-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label> <textarea id="modal-voucher-description" placeholder="Enter description (optional)" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea></div> <div class="flex gap-2 pt-4"><button type="submit" class="flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium text-sm"> </button> <button type="button" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium text-sm">Cancel</button></div></form></div></dialog> <dialog class="p-0 rounded-lg shadow-xl max-w-sm svelte-1w11x2y" style="margin: 1rem auto; width: calc(100% - 2rem);"><div class="p-6"><div class="flex items-center gap-3 mb-4"><div class="flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.502 0L4.312 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div> <div class="flex-1"><h3 class="text-lg font-semibold text-gray-900">Delete Voucher</h3> <p class="text-sm text-gray-600 mt-1"> </p></div></div> <div class="flex gap-3 justify-end"><button type="button" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium text-sm">Cancel</button> <button type="button" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium text-sm">Delete</button></div></div></dialog> <dialog class="p-0 rounded-lg shadow-xl max-w-sm svelte-1w11x2y" style="margin: 1rem auto; width: calc(100% - 2rem);"><div class="p-6"><div class="flex items-center gap-3 mb-4"><div class="flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L12 12"></path></svg></div> <div class="flex-1"><h3 class="text-lg font-semibold text-gray-900">Hide Voucher</h3> <p class="text-sm text-gray-600 mt-1"> </p></div></div> <div class="flex gap-3 justify-end"><button type="button" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium text-sm">Cancel</button> <button type="button" class="px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors font-medium text-sm">Hide</button></div></div></dialog> <dialog class="p-0 rounded-lg shadow-xl max-w-sm svelte-1w11x2y" style="margin: 1rem auto; width: calc(100% - 2rem);"><div class="p-6"><div class="flex items-center gap-3 mb-4"><div class="flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-orange-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.502 0L4.312 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div> <div class="flex-1"><h3 class="text-lg font-semibold text-gray-900">Force Refresh</h3> <p class="text-sm text-gray-600 mt-1">This will clear all cached data and fetch fresh vouchers. Any hidden
          vouchers will reappear. Continue?</p></div></div> <div class="flex gap-3 justify-end"><button type="button" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium text-sm">Cancel</button> <button type="button" class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors font-medium text-sm">Force Refresh</button></div></div></dialog>`,1);function ma(r,o){Co(o,!1);const i=k(),d=k(),u=k(),v=k(),p=k(),b=k(),O=k(),N="grabfood-voucher-cache",g=2*30*24*60*60*1e3,I=["NoCodeRequired","NoCouponRequired"];function x(t){return I.includes(t)}let _=k(!0),w=k(null),m=k([]),Y=[],E=[],$=k(null),ee=null,V=k([]),R=k(null),J=k(""),K=k(""),X=k(""),te=k("GrabFood"),Q=k(),ue=k(),oe=k(null),ve=k(),ae=k(null),fe=k(),M=k([]);const ot="grabfood-custom-vouchers",at=["NoCodeRequired","NoCouponRequired"];function or(){try{const t=localStorage.getItem(ot);t&&c(V,JSON.parse(t))}catch(t){console.error("Error loading custom vouchers:",t)}}function Ae(){try{localStorage.setItem(ot,JSON.stringify(e(V)))}catch(t){console.error("Error saving custom vouchers:",t)}}function ar(){try{c(M,[]);for(let t=0;t<localStorage.length;t++){const l=localStorage.key(t);if(l&&l.startsWith(N)){const h=localStorage.getItem(l);if(h&&JSON.parse(h).hidden){const U=l.replace(`${N}-`,"");e(M).push(U)}}}c(M,[...e(M)])}catch(t){console.error("Error loading hidden vouchers:",t)}}function nr(t){if(!e(M).includes(t)){let l=nt(t);l||(l={code:null,expire:Date.now()+g,hidden:!1});const h={...l,expire:Date.now()+g,hidden:!0};localStorage.setItem(`${N}-${t}`,JSON.stringify(h)),c(M,[...e(M),t])}}function sr(){if(!e(J).trim())return;const t={id:Date.now().toString(),code:e(J).trim(),description:e(K).trim()||"Custom voucher",cta:e(X).trim()||"Use this code",merchantName:e(te)};c(V,[t,...e(V)]),Ae(),Se(),e(Q).close()}function ir(){!e(R)||!e(J).trim()||(c(V,e(V).map(t=>t.id===e(R).id?{...t,code:e(J).trim(),description:e(K).trim()||"Custom voucher",cta:e(X).trim()||"Use this code",merchantName:e(te)}:t)),Ae(),Se(),e(Q).close())}function lr(t){c(V,e(V).filter(l=>l.id!==t)),Ae()}function cr(t){c(oe,t),e(ue).showModal()}function dr(){e(oe)&&(lr(e(oe).id),c(oe,null)),e(ue).close()}function ur(){c(oe,null),e(ue).close()}function vr(t){c(ae,t),e(ve).showModal()}function fr(){e(ae)&&(nr(e(ae).id),c(ae,null)),e(ve).close()}function hr(){c(ae,null),e(ve).close()}function mr(){e(fe).showModal()}function pr(){e(fe).close(),Cr()}function gr(){e(fe).close()}function br(t){c(R,t),c(J,t.code),c(K,t.description),c(X,t.cta),c(te,t.merchantName||"GrabFood"),e(Q).showModal()}function Se(){c(R,null),c(J,""),c(K,""),c(X,""),c(te,"GrabFood")}function nt(t){try{const l=localStorage.getItem(`${N}-${t}`);if(!l)return null;const h=JSON.parse(l);return Date.now()>h.expire?(localStorage.removeItem(`${N}-${t}`),null):h}catch(l){return console.error("Error reading cache for",t,l),null}}function st(t){try{const l=localStorage.getItem(`${N}-${t}`);if(!l)return null;const h=JSON.parse(l);return Date.now()>h.expire?(localStorage.removeItem(`${N}-${t}`),null):{code:h.code,cta:h.cta,headline:h.headline,description:h.description,merchantName:h.merchantName}}catch(l){return console.error("Error reading cache for",t,l),null}}function xr(t,l){try{const h=nt(t),F={...l,expire:Date.now()+g,hidden:h?.hidden||!1};localStorage.setItem(`${N}-${t}`,JSON.stringify(F))}catch(h){console.error("Error caching data for",t,h)}}function _r(){try{Object.keys(localStorage).forEach(l=>{l.startsWith(N)&&localStorage.removeItem(l)}),console.log("Voucher cache cleared")}catch(t){console.error("Error clearing cache:",t)}}async function wr(t){const l=st(t);if(l)return console.log(`Using cached data for article ${t}`),l;try{const h=`https://www.philstar.com/coupons/api/offers/16/en/${t}`,U=await fetch("https://corsproxy.io/?"+encodeURIComponent(h));if(!U.ok)return console.error(`API request failed for ${t}: ${U.status}`),null;const T=await U.json();console.log("data",T);const C={code:null,cta:`${T.cta.heading} ${T.cta.value}`.trim(),headline:T.headline||T.title||"No headline available",description:T.description||T.content||"No description available",merchantName:T.merchant?.name||"Unknown merchant"};if(T&&T.code){const A=T.code.replace(/[^A-Za-z0-9]/g,"");x(A)||(C.code=A)}return xr(t,C),console.log(`Cached data for article ${t}`),C}catch(h){return console.error(`Error fetching voucher code for ${t}:`,h),null}}async function xe(){try{c(_,!0),c(w,null);const t=["https://www.philstar.com/coupons/grabfood","https://www.philstar.com/coupons/foodpanda"],l="https://corsproxy.io/?",h=[],F=[];for(const y of t){console.log(`Fetching from: ${y}`);const C=await fetch(l+encodeURIComponent(y));if(!C.ok){console.error(`HTTP error for ${y}! status: ${C.status}`);continue}const A=await C.text();new DOMParser().parseFromString(A,"text/html").querySelectorAll('article[data-type="code"]').forEach(q=>{const ne=(q.getAttribute("id")||"").replace(/[^A-Za-z0-9]/g,""),se=q.getAttribute("data-type")||"";if(ne&&se==="code"){const ce=q.querySelector('h3, .title, [class*="title"]')?.textContent?.trim()||"No title found",je=q.querySelector('p, .description, [class*="description"]')?.textContent?.trim()||"No description found",Je=q.querySelector('.cta, .call-to-action, [class*="cta"], button, .btn, [class*="button"]')?.textContent?.trim()||"View Offer";h.push({id:ne,dataType:se,title:ce,content:je,cta:Je}),F.push(ne)}})}c(m,h),Y=F,console.log('Found article IDs with data-type="code":',F),E=[],c(m,[...h]),console.log("Fetching coupon codes...");let U=0,T=0;for(let y=0;y<h.length;y++){const C=h[y],A=st(C.id);if(A)console.log(`Using cached data for article ${y+1}/${h.length}: ${C.id}`),U++,A.code&&(Z(m,e(m)[y].couponCode=A.code),Z(m,e(m)[y].cta=A.cta),Z(m,e(m)[y].headline=A.headline),Z(m,e(m)[y].description=A.description),Z(m,e(m)[y].merchantName=A.merchantName),c(m,[...e(m)]));else{console.log(`Fetching from API for article ${y+1}/${h.length}: ${C.id}`),T++;const B=await wr(C.id);B&&B.code&&(Z(m,e(m)[y].couponCode=B.code),Z(m,e(m)[y].cta=B.cta),Z(m,e(m)[y].headline=B.headline),Z(m,e(m)[y].description=B.description),Z(m,e(m)[y].merchantName=B.merchantName),c(m,[...e(m)])),await new Promise(a=>setTimeout(a,500))}}console.log(`Cache performance - Hits: ${U}, API calls: ${T}`),console.log("Progressive loading completed")}catch(t){c(w,t instanceof Error?t.message:"An unknown error occurred"),console.error("Error fetching GrabFood vouchers:",t)}finally{c(_,!1)}}Mo(()=>{xe(),or(),ar()});function yr(t){navigator.clipboard.writeText(t).then(()=>{ee&&clearTimeout(ee),c($,t),ee=setTimeout(()=>{c($,null),ee=null},2e3)})}async function Cr(){_r(),await xe()}le(()=>(e(m),e(M)),()=>{c(i,e(m).filter(t=>t.couponCode&&!at.includes(t.couponCode)&&!e(M).includes(t.id||"")).map(t=>t.couponCode))}),le(()=>(e(m),e(M)),()=>{c(d,e(m).filter(t=>!at.includes(t.couponCode||"")&&!e(M).includes(t.id||"")))}),le(()=>(e(V),e(d)),()=>{c(u,[...e(V).map(t=>({...t,isCustom:!0,voucherCode:t.code,cta:t.cta,description:t.description})),...e(d).map(t=>({...t,isCustom:!1,voucherCode:t.couponCode}))])}),le(()=>e(V),()=>{c(v,e(V).filter(t=>t.code&&t.code.trim()!==""&&t.code!=="No code found").length)}),le(()=>e(d),()=>{c(p,e(d).filter(t=>t.couponCode&&t.couponCode.trim()!==""&&t.couponCode!=="No code found"&&(t.merchantName?.toLowerCase().includes("grabfood")||t.merchantName?.toLowerCase().includes("grab"))).length)}),le(()=>e(d),()=>{c(b,e(d).filter(t=>t.couponCode&&t.couponCode.trim()!==""&&t.couponCode!=="No code found"&&t.merchantName?.toLowerCase().includes("foodpanda")).length)}),le(()=>(e(v),e(p),e(b)),()=>{c(O,e(v)+e(p)+e(b))}),ko(),Oo();var it=ha(),_e=Ze(it),Ve=s(_e),lt=s(Ve),ct=s(lt),De=s(ct),$e=s(De),kr=s($e);n($e);var Nr=f($e,2);{var Er=t=>{var l=ra(),h=s(l);{var F=a=>{var S=Wo(),q=s(S);n(S),W(()=>P(q,`${e(v)??""} Custom`)),D(a,S)};G(h,a=>{e(v)>0&&a(F)})}var U=f(h,2);{var T=a=>{var S=Zo(),q=s(S);n(S),W(()=>P(q,`${e(p)??""} GrabFood`)),D(a,S)};G(U,a=>{e(p)>0&&a(T)})}var y=f(U,2);{var C=a=>{var S=ea(),q=s(S);n(S),W(()=>P(q,`${e(b)??""} FoodPanda`)),D(a,S)};G(y,a=>{e(b)>0&&a(C)})}var A=f(y,2);{var B=a=>{var S=ta(),q=s(S);n(S),W(()=>P(q,`${e(M),z(()=>e(M).length)??""} Hidden`)),D(a,S)};G(A,a=>{e(M),z(()=>e(M).length>0)&&a(B)})}n(l),D(t,l)};G(Nr,t=>{e(v),e(p),e(b),e(M),z(()=>e(v)>0||e(p)>0||e(b)>0||e(M).length>0)&&t(Er)})}n(De);var dt=f(De,2),ut=s(dt),vt=f(ut,2),he=s(vt),Ar=s(he);{var Sr=t=>{var l=oa();D(t,l)},Vr=t=>{var l=So("Refresh");D(t,l)};G(Ar,t=>{e(_)?t(Sr):t(Vr,!1)})}n(he);var ft=f(he,2);n(vt),n(dt),n(ct),n(lt),n(Ve);var ht=f(Ve,2),mt=s(ht),pt=s(mt);{var Dr=t=>{var l=aa(),h=f(s(l),2),F=s(h);n(h),n(l),W(()=>P(F,`Copied "${e($)??""}"!`)),D(t,l)};G(pt,t=>{e($)&&t(Dr)})}var gt=f(pt,2);{var $r=t=>{var l=na(),h=f(s(l),2),F=s(h,!0);n(h);var U=f(h,2);n(l),W(()=>P(F,e(w))),L("click",U,xe),D(t,l)};G(gt,t=>{e(w)&&t($r)})}var Tr=f(gt,2);{var Mr=t=>{var l=fa(),h=Ze(l);{var F=C=>{var A=da();Uo(A,5,()=>e(u),Ro,(B,a)=>{var S=Vo(),q=Ze(S);{var Ot=ne=>{var se=ca(),ke=s(se),ce=s(ke),Pe=s(ce),je=s(Pe,!0);n(Pe),Do(2),n(ce),n(ke);var Rt=f(ke,2);{var Je=me=>{var pe=la(),Ye=s(pe),Ke=s(Ye),zr=s(Ke,!0);n(Ke);var It=f(Ke,2),Ut=s(It),qt=s(Ut),Br=s(qt,!0);n(qt),n(Ut),n(It),n(Ye);var Pr=f(Ye,2);{var jr=de=>{var ie=sa(),Ne=s(ie),Yr=f(Ne,2);n(ie),L("click",Ne,()=>br({id:e(a).id,code:e(a).voucherCode||"",description:e(a).description||"",cta:e(a).cta||""})),L("click",Yr,()=>cr({id:e(a).id,code:e(a).voucherCode||"",description:e(a).description||"",cta:e(a).cta||""})),D(de,ie)},Jr=de=>{var ie=ia(),Ne=s(ie);n(ie),L("click",Ne,()=>vr({id:e(a).id,voucherCode:e(a).voucherCode||""})),D(de,ie)};G(Pr,de=>{e(a),z(()=>e(a).isCustom)?de(jr):de(Jr,!1)})}n(pe),W(()=>{P(zr,(e(a),z(()=>e(a).cta||"View Details"))),P(Br,(e(a),z(()=>e(a).description||"No description available")))}),D(me,pe)};G(Rt,me=>{e(a),z(()=>e(a).cta||!e(a).isCustom&&e(a).headline||e(a).description)&&me(Je)})}n(se),W((me,pe)=>{jt(se,1,`p-3 sm:p-4 rounded-lg border shadow-lg ${me??""}`),jt(ce,1,`w-full text-base sm:text-lg font-bold font-mono bg-white/95 px-3 py-2 rounded border border-white/60 break-all flex items-center justify-between hover:bg-white transition-all cursor-pointer shadow-sm ${pe??""}`),P(je,(e(a),z(()=>e(a).voucherCode)))},[()=>(e(a),z(()=>"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("grabfood")||"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("grab")?"bg-green-100/95 border-green-300/100":"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("foodpanda")?"bg-pink-100/95 border-pink-300/100":"bg-gray-200/95 border-gray-400/100")),()=>(e(a),z(()=>"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("grabfood")||"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("grab")?"text-green-700":"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("foodpanda")?"text-pink-700":"text-gray-700"))],Kt),L("click",ce,()=>yr(e(a).voucherCode||"")),D(ne,se)};G(q,ne=>{e(a),z(()=>e(a).voucherCode)&&ne(Ot)})}D(B,S)}),n(A),D(C,A)},U=(C,A)=>{{var B=a=>{var S=ua();D(a,S)};G(C,a=>{e(_)||a(B)},A)}};G(h,C=>{e(u),z(()=>e(u).length>0)?C(F):C(U,!1)})}var T=f(h,2);{var y=C=>{var A=va();D(C,A)};G(T,C=>{e(_)&&C(y)})}D(t,l)};G(Tr,t=>{e(w)||t(Mr)})}n(mt),n(ht),n(_e);var we=f(_e,2),bt=s(we),Te=s(bt),Me=s(Te),Fr=s(Me);n(Me);var Lr=f(Me,2);n(Te);var Fe=f(Te,4),Le=s(Fe),xt=f(s(Le),2);Jt(xt),n(Le);var He=f(Le,2),Oe=f(s(He),2);W(()=>{e(te),Eo(()=>{})});var Re=s(Oe);Re.value=Re.__value="GrabFood";var _t=f(Re);_t.value=_t.__value="Foodpanda",n(Oe),n(He);var Ie=f(He,2),wt=f(s(Ie),2);Jt(wt),n(Ie);var Ue=f(Ie,2),yt=f(s(Ue),2);Fo(yt),n(Ue);var Ct=f(Ue,2),qe=s(Ct),Hr=s(qe);n(qe);var Or=f(qe,2);n(Ct),n(Fe),n(bt),n(we),Ee(we,t=>c(Q,t),()=>e(Q));var ye=f(we,2),kt=s(ye),Ge=s(kt),Nt=f(s(Ge),2),Et=f(s(Nt),2),Rr=s(Et);n(Et),n(Nt),n(Ge);var At=f(Ge,2),St=s(At),Ir=f(St,2);n(At),n(kt),n(ye),Ee(ye,t=>c(ue,t),()=>e(ue));var Ce=f(ye,2),Vt=s(Ce),ze=s(Vt),Dt=f(s(ze),2),$t=f(s(Dt),2),Ur=s($t);n($t),n(Dt),n(ze);var Tt=f(ze,2),Mt=s(Tt),qr=f(Mt,2);n(Tt),n(Vt),n(Ce),Ee(Ce,t=>c(ve,t),()=>e(ve));var Be=f(Ce,2),Ft=s(Be),Lt=f(s(Ft),2),Ht=s(Lt),Gr=f(Ht,2);n(Lt),n(Ft),n(Be),Ee(Be,t=>c(fe,t),()=>e(fe)),W(()=>{Po(_e,`background-image: url('${Ho??""}/background.png');`),P(kr,`${e(O)??""} Codes`),he.disabled=e(_),ft.disabled=e(_),P(Fr,`${e(R)?"Edit":"Add"} Custom Voucher`),P(Hr,`${e(R)?"Update":"Add"} Voucher`),P(Rr,`Are you sure you want to delete "${e(oe),z(()=>e(oe)?.code)??""}"? This action
          cannot be undone.`),P(Ur,`Are you sure you want to hide "${e(ae),z(()=>e(ae)?.voucherCode)??""}"? Hidden
          vouchers will reappear when you force refresh the page.`)}),L("click",ut,()=>{Se(),e(Q).showModal()}),L("click",he,xe),L("click",ft,mr),L("click",Lr,()=>e(Q).close()),et(xt,()=>e(J),t=>c(J,t)),Jo(Oe,()=>e(te),t=>c(te,t)),et(wt,()=>e(X),t=>c(X,t)),et(yt,()=>e(K),t=>c(K,t)),L("click",Or,()=>e(Q).close()),L("submit",Fe,Qo(function(...t){(e(R)?ir:sr)?.apply(this,t)})),L("click",St,ur),L("click",Ir,dr),L("click",Mt,hr),L("click",qr,fr),L("click",Ht,gr),L("click",Gr,pr),D(r,it),No()}var pa=H('<meta name="description" content="Get the latest GrabFood vouchers. Save money on your food delivery orders with verified promo codes from restaurants across the Philippines."/>');function ka(r){Lo(o=>{var i=pa();$o.title="GrabFood Voucher Codes",D(o,i)}),ma(r,{})}export{ka as component};
