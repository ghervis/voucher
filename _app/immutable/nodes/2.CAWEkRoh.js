import"../chunks/NZTpNUN0.js";import"../chunks/CwkVU6ps.js";import{s as Xe,j,K as Kr,V as Xr,k as Qr,i as Wr,g as e,aj as Kt,l as Zr,m as eo,n as Gt,o as Qe,v as ge,X as to,$ as ro,p as Xt,q as Qt,t as oo,a2 as Wt,T as Zt,at as k,ay as zt,az as We,O as Bt,aA as ao,aB as no,aC as so,L as io,aD as lo,aE as co,aF as uo,aG as vo,Y as fo,w as mo,Q as ho,aH as po,aI as go,aJ as bo,aK as xo,aL as _o,aM as wo,b as z,x as yo,z as Co,aN as le,aO as ko,A as H,B as Ze,C as W,G as s,J as u,D,F as No,al as c,I as n,aP as Eo,aQ as Z,aR as Vo,ax as So,av as Ao,aS as Do,aT as $o}from"../chunks/C88vm6q9.js";import{l as er,a as Mo,o as To,e as L,r as Fo,s as P,b as Lo}from"../chunks/D4tB4DRY.js";import"../chunks/dR2ARH6f.js";import{i as G,b as Ne}from"../chunks/6g30B3Hu.js";import{i as Ho}from"../chunks/Bj_Ne2mG.js";function Oo(r,o){return o}function Ro(r,o,i,d){for(var v=[],m=o.length,p=0;p<m;p++)so(o[p].e,v,!0);var b=m>0&&v.length===0&&i!==null;if(b){var O=i.parentNode;io(O),O.append(i),d.clear(),re(r,o[0].prev,o[m-1].next)}lo(v,()=>{for(var N=0;N<m;N++){var g=o[N];b||(d.delete(g.k),re(r,g.prev,g.next)),co(g.e,!b)}})}function Io(r,o,i,d,v,m=null){var p=r,b={flags:o,items:new Map,first:null};{var O=r;p=j?Xe(Kr(O)):O.appendChild(Xr())}j&&Qr();var N=null,g=!1,I=Kt(()=>{var x=i();return Zt(x)?x:x==null?[]:Wt(x)});Wr(()=>{var x=e(I),_=x.length;if(g&&_===0)return;g=_===0;let w=!1;if(j){var h=Zr(p)===eo;h!==(_===0)&&(p=Gt(),Xe(p),Qe(!1),w=!0)}if(j){for(var Y=null,E,$=0;$<_;$++){if(ge.nodeType===to&&ge.data===ro){p=ge,w=!0,Qe(!1);break}var ee=x[$],A=d(ee,$);E=tr(ge,b,Y,null,ee,A,$,v,o,i),b.items.set(A,E),Y=E}_>0&&Xe(Gt())}j||Uo(x,b,p,v,o,d,i),m!==null&&(_===0?N?Xt(N):N=Qt(()=>m(p)):N!==null&&oo(N,()=>{N=null})),w&&Qe(!0),e(I)}),j&&(p=ge)}function Uo(r,o,i,d,v,m,p){var b=r.length,O=o.items,N=o.first,g=N,I,x=null,_=[],w=[],h,Y,E,$;for($=0;$<b;$+=1){if(h=r[$],Y=m(h,$),E=O.get(Y),E===void 0){var ee=g?g.e.nodes_start:i;x=tr(ee,o,x,x===null?o.first:x.next,h,Y,$,d,v,p),O.set(Y,x),_=[],w=[],g=x.next;continue}if(qo(E,h,$),(E.e.f&We)!==0&&Xt(E.e),E!==g){if(I!==void 0&&I.has(E)){if(_.length<w.length){var A=w[0],R;x=A.prev;var J=_[0],K=_[_.length-1];for(R=0;R<_.length;R+=1)Pt(_[R],A,i);for(R=0;R<w.length;R+=1)I.delete(w[R]);re(o,J.prev,K.next),re(o,x,J),re(o,K,A),g=A,x=K,$-=1,_=[],w=[]}else I.delete(E),Pt(E,g,i),re(o,E.prev,E.next),re(o,E,x===null?o.first:x.next),re(o,x,E),x=E;continue}for(_=[],w=[];g!==null&&g.k!==Y;)(g.e.f&We)===0&&(I??=new Set).add(g),w.push(g),g=g.next;if(g===null)continue;E=g}_.push(E),x=E,g=E.next}if(g!==null||I!==void 0){for(var X=I===void 0?[]:Wt(I);g!==null;)(g.e.f&We)===0&&X.push(g),g=g.next;var te=X.length;if(te>0){var Q=b===0?i:null;Ro(o,X,Q,O)}}Bt.first=o.first&&o.first.e,Bt.last=x&&x.e}function qo(r,o,i,d){no(r.v,o),r.i=i}function tr(r,o,i,d,v,m,p,b,O,N){var g=(O&uo)!==0,I=(O&vo)===0,x=g?I?k(v,!1,!1):zt(v):v,_=(O&ao)===0?p:zt(p),w={i:_,v:x,k:m,a:null,e:null,prev:i,next:d};try{return w.e=Qt(()=>b(r,x,_,N),j),w.e.prev=i&&i.e,w.e.next=d&&d.e,i===null?o.first=w:(i.next=w,i.e.next=w.e),d!==null&&(d.prev=w,d.e.prev=w.e),w}finally{}}function Pt(r,o,i){for(var d=r.next?r.next.e.nodes_start:i,v=o?o.e.nodes_start:i,m=r.e.nodes_start;m!==d;){var p=fo(m);v.before(m),m=p}}function re(r,o,i){o===null?r.first=i:(o.next=i,o.e.next=i&&i.e),i!==null&&(i.prev=o,i.e.prev=o&&o.e)}function Go(r,o,i){var d=r==null?"":""+r;return d===""?null:d}function jt(r,o,i,d,v,m){var p=r.__className;if(j||p!==i||p===void 0){var b=Go(i);(!j||b!==r.getAttribute("class"))&&(b==null?r.removeAttribute("class"):r.className=b),r.__className=i}return m}function rr(r,o,i=!1){if(r.multiple){if(o==null)return;if(!Zt(o))return po();for(var d of r.options)d.selected=o.includes(be(d));return}for(d of r.options){var v=be(d);if(go(v,o)){d.selected=!0;return}}(!i||o!==void 0)&&(r.selectedIndex=-1)}function zo(r){var o=new MutationObserver(()=>{rr(r,r.__value)});o.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ho(()=>{o.disconnect()})}function Bo(r,o,i=o){var d=!0;er(r,"change",v=>{var m=v?"[selected]":":checked",p;if(r.multiple)p=[].map.call(r.querySelectorAll(m),be);else{var b=r.querySelector(m)??r.querySelector("option:not([disabled])");p=b&&be(b)}i(p)}),mo(()=>{var v=o();if(rr(r,v,d),d&&v===void 0){var m=r.querySelector(":checked");m!==null&&(v=be(m),i(v))}r.__value=v,d=!1}),zo(r)}function be(r){return"__value"in r?r.__value:r.value}const Po=Symbol("is custom element"),jo=Symbol("is html");function Jt(r){if(j){var o=!1,i=()=>{if(!o){if(o=!0,r.hasAttribute("value")){var d=r.value;Yt(r,"value",null),r.value=d}if(r.hasAttribute("checked")){var v=r.checked;Yt(r,"checked",null),r.checked=v}}};r.__on_r=i,bo(i),Mo()}}function Yt(r,o,i,d){var v=Jo(r);j&&(v[o]=r.getAttribute(o),o==="src"||o==="srcset"||o==="href"&&r.nodeName==="LINK")||v[o]!==(v[o]=i)&&(o==="loading"&&(r[xo]=i),r.removeAttribute(o))}function Jo(r){return r.__attributes??={[Po]:r.nodeName.includes("-"),[jo]:r.namespaceURI===_o}}function et(r,o,i=o){var d=wo();er(r,"input",v=>{var m=v?r.defaultValue:r.value;if(m=tt(r)?rt(m):m,i(m),d&&m!==(m=o())){var p=r.selectionStart,b=r.selectionEnd;r.value=m??"",b!==null&&(r.selectionStart=p,r.selectionEnd=Math.min(b,r.value.length))}}),(j&&r.defaultValue!==r.value||z(o)==null&&r.value)&&i(tt(r)?rt(r.value):r.value),yo(()=>{var v=o();tt(r)&&v===rt(r.value)||r.type==="date"&&!v&&!r.value||v!==r.value&&(r.value=v??"")})}function tt(r){var o=r.type;return o==="number"||o==="range"}function rt(r){return r===""?null:+r}function Yo(r){return function(...o){var i=o[0];return i.preventDefault(),r?.apply(this,o)}}var Ko=H("<div> </div>"),Xo=H("<div> </div>"),Qo=H("<div> </div>"),Wo=H("<div> </div>"),Zo=H('<div class="text-xs text-gray-600 mt-1 space-y-0.5"><!> <!> <!> <!></div>'),ea=Vo('<svg class="animate-spin h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),ta=H('<div class="fixed top-20 right-4 bg-green-600 text-white px-4 py-3 rounded-lg shadow-lg z-20 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <span class="text-sm font-medium"> </span></div>'),ra=H('<div class="bg-red-50 border border-red-200 rounded-lg p-4 sm:p-6 mb-6 sm:mb-8 mx-2 sm:mx-0"><h3 class="text-red-800 font-semibold mb-2 text-sm sm:text-base">Error Loading Data</h3> <p class="text-red-600 mb-4 text-sm"> </p> <button class="w-full sm:w-auto px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors text-sm">Try Again</button></div>'),oa=H('<div class="absolute top-0 right-0 flex gap-2"><button class="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors text-sm shadow-sm" title="Edit voucher">Edit</button> <button class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors text-sm shadow-sm" title="Delete voucher">Delete</button></div>'),aa=H('<div class="absolute top-0 right-0 flex gap-2"><button class="px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors text-sm shadow-sm" title="Hide voucher">Hide</button></div>'),na=H('<div class="mt-3 relative"><details class="w-full"><summary class="cursor-pointer text-sm font-semibold text-gray-700 hover:text-gray-900 py-1"> </summary> <div class="mt-3 p-3 backdrop-blur-sm bg-white/85 rounded border border-white/40 text-sm space-y-2 shadow-sm"><div><p class="text-gray-600 mt-1 leading-relaxed"> </p></div></div></details> <!></div>'),sa=H('<div><div class="mb-3"><button title="Click to copy voucher code" aria-label="Copy voucher code"><span class="flex-1 text-left"> </span> <div class="flex items-center gap-2 ml-2 flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></div></button></div> <!></div>'),ia=H('<div class="space-y-3 sm:space-y-4 mb-6 sm:mb-8"></div>'),la=H('<div class="text-center py-8 bg-gray-50 rounded-lg border border-gray-200"><p class="text-gray-500 mb-2">No vouchers available</p> <p class="text-sm text-gray-400">Add a custom voucher or refresh to fetch GrabFood vouchers</p></div>'),ca=H('<div class="text-center py-8"><div class="inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div> <p class="text-gray-600 mt-2 text-sm">Fetching more vouchers...</p></div>'),da=H("<!> <!>",1),ua=H(`<div class="h-screen flex flex-col bg-cover bg-center bg-no-repeat" style="background-image: url('/background.png');"><div class="sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm"><div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4"><div class="flex flex-row items-start justify-between gap-4"><div class="flex-1"><h1 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900"> </h1> <!></div> <div class="flex flex-col gap-2 items-end flex-shrink-0"><button class="px-4 sm:px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium text-xs sm:text-sm whitespace-nowrap">Add Custom Voucher</button> <div class="flex gap-2"><button class="px-4 sm:px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-xs sm:text-sm whitespace-nowrap"><!></button> <button class="px-4 sm:px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors font-medium text-xs sm:text-sm whitespace-nowrap" title="Clear cache and fetch fresh data">Force</button></div></div></div></div></div> <div class="flex-1 overflow-y-auto"><div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8"><!> <!> <!></div></div></div> <dialog class="p-0 rounded-lg shadow-xl max-w-md svelte-1w11x2y" style="margin: 1rem auto; width: calc(100% - 2rem);"><div class="p-6"><div class="flex justify-between items-center mb-4"><h3 class="text-lg font-semibold text-purple-800"> </h3> <button class="text-gray-400 hover:text-gray-600 transition-colors" aria-label="Close modal"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="mb-4 p-2 bg-blue-50 border border-blue-200 rounded-lg"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-600 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="text-xs text-blue-700">Only you can see this addition.</p></div></div> <form class="space-y-4"><div><label for="modal-voucher-code" class="block text-sm font-medium text-gray-700 mb-1">Voucher Code *</label> <input id="modal-voucher-code" type="text" placeholder="Enter voucher code" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"/></div> <div><label for="modal-voucher-merchant" class="block text-sm font-medium text-gray-700 mb-1">Merchant *</label> <select id="modal-voucher-merchant" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"><option>GrabFood</option><option>Foodpanda</option></select></div> <div><label for="modal-voucher-cta" class="block text-sm font-medium text-gray-700 mb-1">Title *</label> <input id="modal-voucher-cta" type="text" placeholder="e.g., 'Save 20% on your order'" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div> <div><label for="modal-voucher-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label> <textarea id="modal-voucher-description" placeholder="Enter description (optional)" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea></div> <div class="flex gap-2 pt-4"><button type="submit" class="flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium text-sm"> </button> <button type="button" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium text-sm">Cancel</button></div></form></div></dialog> <dialog class="p-0 rounded-lg shadow-xl max-w-sm svelte-1w11x2y" style="margin: 1rem auto; width: calc(100% - 2rem);"><div class="p-6"><div class="flex items-center gap-3 mb-4"><div class="flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.502 0L4.312 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div> <div class="flex-1"><h3 class="text-lg font-semibold text-gray-900">Delete Voucher</h3> <p class="text-sm text-gray-600 mt-1"> </p></div></div> <div class="flex gap-3 justify-end"><button type="button" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium text-sm">Cancel</button> <button type="button" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium text-sm">Delete</button></div></div></dialog> <dialog class="p-0 rounded-lg shadow-xl max-w-sm svelte-1w11x2y" style="margin: 1rem auto; width: calc(100% - 2rem);"><div class="p-6"><div class="flex items-center gap-3 mb-4"><div class="flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L12 12"></path></svg></div> <div class="flex-1"><h3 class="text-lg font-semibold text-gray-900">Hide Voucher</h3> <p class="text-sm text-gray-600 mt-1"> </p></div></div> <div class="flex gap-3 justify-end"><button type="button" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium text-sm">Cancel</button> <button type="button" class="px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors font-medium text-sm">Hide</button></div></div></dialog> <dialog class="p-0 rounded-lg shadow-xl max-w-sm svelte-1w11x2y" style="margin: 1rem auto; width: calc(100% - 2rem);"><div class="p-6"><div class="flex items-center gap-3 mb-4"><div class="flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-orange-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.502 0L4.312 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div> <div class="flex-1"><h3 class="text-lg font-semibold text-gray-900">Force Refresh</h3> <p class="text-sm text-gray-600 mt-1">This will clear all cached data and fetch fresh vouchers. Any hidden
          vouchers will reappear. Continue?</p></div></div> <div class="flex gap-3 justify-end"><button type="button" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium text-sm">Cancel</button> <button type="button" class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors font-medium text-sm">Force Refresh</button></div></div></dialog>`,1);function va(r,o){Co(o,!1);const i=k(),d=k(),v=k(),m=k(),p=k(),b=k(),O=k(),N="grabfood-voucher-cache",g=2*30*24*60*60*1e3,I=["NoCodeRequired","NoCouponRequired"];function x(t){return I.includes(t)}let _=k(!0),w=k(null),h=k([]),Y=[],E=[],$=k(null),ee=null,A=k([]),R=k(null),J=k(""),K=k(""),X=k(""),te=k("GrabFood"),Q=k(),ue=k(),oe=k(null),ve=k(),ae=k(null),fe=k(),T=k([]);const ot="grabfood-custom-vouchers",at=["NoCodeRequired","NoCouponRequired"];function or(){try{const t=localStorage.getItem(ot);t&&c(A,JSON.parse(t))}catch(t){console.error("Error loading custom vouchers:",t)}}function Ee(){try{localStorage.setItem(ot,JSON.stringify(e(A)))}catch(t){console.error("Error saving custom vouchers:",t)}}function ar(){try{c(T,[]);for(let t=0;t<localStorage.length;t++){const l=localStorage.key(t);if(l&&l.startsWith(N)){const f=localStorage.getItem(l);if(f&&JSON.parse(f).hidden){const U=l.replace(`${N}-`,"");e(T).push(U)}}}c(T,[...e(T)])}catch(t){console.error("Error loading hidden vouchers:",t)}}function nr(t){if(!e(T).includes(t)){let l=nt(t);l||(l={code:null,expire:Date.now()+g,hidden:!1});const f={...l,expire:Date.now()+g,hidden:!0};localStorage.setItem(`${N}-${t}`,JSON.stringify(f)),c(T,[...e(T),t])}}function sr(){if(!e(J).trim())return;const t={id:Date.now().toString(),code:e(J).trim(),description:e(K).trim()||"Custom voucher",cta:e(X).trim()||"Use this code",merchantName:e(te)};c(A,[t,...e(A)]),Ee(),Ve(),e(Q).close()}function ir(){!e(R)||!e(J).trim()||(c(A,e(A).map(t=>t.id===e(R).id?{...t,code:e(J).trim(),description:e(K).trim()||"Custom voucher",cta:e(X).trim()||"Use this code",merchantName:e(te)}:t)),Ee(),Ve(),e(Q).close())}function lr(t){c(A,e(A).filter(l=>l.id!==t)),Ee()}function cr(t){c(oe,t),e(ue).showModal()}function dr(){e(oe)&&(lr(e(oe).id),c(oe,null)),e(ue).close()}function ur(){c(oe,null),e(ue).close()}function vr(t){c(ae,t),e(ve).showModal()}function fr(){e(ae)&&(nr(e(ae).id),c(ae,null)),e(ve).close()}function mr(){c(ae,null),e(ve).close()}function hr(){e(fe).showModal()}function pr(){e(fe).close(),Cr()}function gr(){e(fe).close()}function br(t){c(R,t),c(J,t.code),c(K,t.description),c(X,t.cta),c(te,t.merchantName||"GrabFood"),e(Q).showModal()}function Ve(){c(R,null),c(J,""),c(K,""),c(X,""),c(te,"GrabFood")}function nt(t){try{const l=localStorage.getItem(`${N}-${t}`);if(!l)return null;const f=JSON.parse(l);return Date.now()>f.expire?(localStorage.removeItem(`${N}-${t}`),null):f}catch(l){return console.error("Error reading cache for",t,l),null}}function st(t){try{const l=localStorage.getItem(`${N}-${t}`);if(!l)return null;const f=JSON.parse(l);return Date.now()>f.expire?(localStorage.removeItem(`${N}-${t}`),null):{code:f.code,cta:f.cta,headline:f.headline,description:f.description,merchantName:f.merchantName}}catch(l){return console.error("Error reading cache for",t,l),null}}function xr(t,l){try{const f=nt(t),F={...l,expire:Date.now()+g,hidden:f?.hidden||!1};localStorage.setItem(`${N}-${t}`,JSON.stringify(F))}catch(f){console.error("Error caching data for",t,f)}}function _r(){try{Object.keys(localStorage).forEach(l=>{l.startsWith(N)&&localStorage.removeItem(l)}),console.log("Voucher cache cleared")}catch(t){console.error("Error clearing cache:",t)}}async function wr(t){const l=st(t);if(l)return console.log(`Using cached data for article ${t}`),l;try{const f=`https://www.philstar.com/coupons/api/offers/16/en/${t}`,U=await fetch("https://corsproxy.io/?"+encodeURIComponent(f));if(!U.ok)return console.error(`API request failed for ${t}: ${U.status}`),null;const M=await U.json();console.log("data",M);const C={code:null,cta:`${M.cta.heading} ${M.cta.value}`.trim(),headline:M.headline||M.title||"No headline available",description:M.description||M.content||"No description available",merchantName:M.merchant?.name||"Unknown merchant"};if(M&&M.code){const V=M.code.replace(/[^A-Za-z0-9]/g,"");x(V)||(C.code=V)}return xr(t,C),console.log(`Cached data for article ${t}`),C}catch(f){return console.error(`Error fetching voucher code for ${t}:`,f),null}}async function xe(){try{c(_,!0),c(w,null);const t=["https://www.philstar.com/coupons/grabfood","https://www.philstar.com/coupons/foodpanda"],l="https://corsproxy.io/?",f=[],F=[];for(const y of t){console.log(`Fetching from: ${y}`);const C=await fetch(l+encodeURIComponent(y));if(!C.ok){console.error(`HTTP error for ${y}! status: ${C.status}`);continue}const V=await C.text();new DOMParser().parseFromString(V,"text/html").querySelectorAll('article[data-type="code"]').forEach(q=>{const ne=(q.getAttribute("id")||"").replace(/[^A-Za-z0-9]/g,""),se=q.getAttribute("data-type")||"";if(ne&&se==="code"){const ce=q.querySelector('h3, .title, [class*="title"]')?.textContent?.trim()||"No title found",je=q.querySelector('p, .description, [class*="description"]')?.textContent?.trim()||"No description found",Je=q.querySelector('.cta, .call-to-action, [class*="cta"], button, .btn, [class*="button"]')?.textContent?.trim()||"View Offer";f.push({id:ne,dataType:se,title:ce,content:je,cta:Je}),F.push(ne)}})}c(h,f),Y=F,console.log('Found article IDs with data-type="code":',F),E=[],c(h,[...f]),console.log("Fetching coupon codes...");let U=0,M=0;for(let y=0;y<f.length;y++){const C=f[y],V=st(C.id);if(V)console.log(`Using cached data for article ${y+1}/${f.length}: ${C.id}`),U++,V.code&&(Z(h,e(h)[y].couponCode=V.code),Z(h,e(h)[y].cta=V.cta),Z(h,e(h)[y].headline=V.headline),Z(h,e(h)[y].description=V.description),Z(h,e(h)[y].merchantName=V.merchantName),c(h,[...e(h)]));else{console.log(`Fetching from API for article ${y+1}/${f.length}: ${C.id}`),M++;const B=await wr(C.id);B&&B.code&&(Z(h,e(h)[y].couponCode=B.code),Z(h,e(h)[y].cta=B.cta),Z(h,e(h)[y].headline=B.headline),Z(h,e(h)[y].description=B.description),Z(h,e(h)[y].merchantName=B.merchantName),c(h,[...e(h)])),await new Promise(a=>setTimeout(a,500))}}console.log(`Cache performance - Hits: ${U}, API calls: ${M}`),console.log("Progressive loading completed")}catch(t){c(w,t instanceof Error?t.message:"An unknown error occurred"),console.error("Error fetching GrabFood vouchers:",t)}finally{c(_,!1)}}To(()=>{xe(),or(),ar()});function yr(t){navigator.clipboard.writeText(t).then(()=>{ee&&clearTimeout(ee),c($,t),ee=setTimeout(()=>{c($,null),ee=null},2e3)})}async function Cr(){_r(),await xe()}le(()=>(e(h),e(T)),()=>{c(i,e(h).filter(t=>t.couponCode&&!at.includes(t.couponCode)&&!e(T).includes(t.id||"")).map(t=>t.couponCode))}),le(()=>(e(h),e(T)),()=>{c(d,e(h).filter(t=>!at.includes(t.couponCode||"")&&!e(T).includes(t.id||"")))}),le(()=>(e(A),e(d)),()=>{c(v,[...e(A).map(t=>({...t,isCustom:!0,voucherCode:t.code,cta:t.cta,description:t.description})),...e(d).map(t=>({...t,isCustom:!1,voucherCode:t.couponCode}))])}),le(()=>e(A),()=>{c(m,e(A).filter(t=>t.code&&t.code.trim()!==""&&t.code!=="No code found").length)}),le(()=>e(d),()=>{c(p,e(d).filter(t=>t.couponCode&&t.couponCode.trim()!==""&&t.couponCode!=="No code found"&&(t.merchantName?.toLowerCase().includes("grabfood")||t.merchantName?.toLowerCase().includes("grab"))).length)}),le(()=>e(d),()=>{c(b,e(d).filter(t=>t.couponCode&&t.couponCode.trim()!==""&&t.couponCode!=="No code found"&&t.merchantName?.toLowerCase().includes("foodpanda")).length)}),le(()=>(e(m),e(p),e(b)),()=>{c(O,e(m)+e(p)+e(b))}),ko(),Ho();var it=ua(),Se=Ze(it),Ae=s(Se),lt=s(Ae),ct=s(lt),De=s(ct),$e=s(De),kr=s($e);n($e);var Nr=u($e,2);{var Er=t=>{var l=Zo(),f=s(l);{var F=a=>{var S=Ko(),q=s(S);n(S),W(()=>P(q,`${e(m)??""} Custom`)),D(a,S)};G(f,a=>{e(m)>0&&a(F)})}var U=u(f,2);{var M=a=>{var S=Xo(),q=s(S);n(S),W(()=>P(q,`${e(p)??""} GrabFood`)),D(a,S)};G(U,a=>{e(p)>0&&a(M)})}var y=u(U,2);{var C=a=>{var S=Qo(),q=s(S);n(S),W(()=>P(q,`${e(b)??""} FoodPanda`)),D(a,S)};G(y,a=>{e(b)>0&&a(C)})}var V=u(y,2);{var B=a=>{var S=Wo(),q=s(S);n(S),W(()=>P(q,`${e(T),z(()=>e(T).length)??""} Hidden`)),D(a,S)};G(V,a=>{e(T),z(()=>e(T).length>0)&&a(B)})}n(l),D(t,l)};G(Nr,t=>{e(m),e(p),e(b),e(T),z(()=>e(m)>0||e(p)>0||e(b)>0||e(T).length>0)&&t(Er)})}n(De);var dt=u(De,2),ut=s(dt),vt=u(ut,2),me=s(vt),Vr=s(me);{var Sr=t=>{var l=ea();D(t,l)},Ar=t=>{var l=So("Refresh");D(t,l)};G(Vr,t=>{e(_)?t(Sr):t(Ar,!1)})}n(me);var ft=u(me,2);n(vt),n(dt),n(ct),n(lt),n(Ae);var mt=u(Ae,2),ht=s(mt),pt=s(ht);{var Dr=t=>{var l=ta(),f=u(s(l),2),F=s(f);n(f),n(l),W(()=>P(F,`Copied "${e($)??""}"!`)),D(t,l)};G(pt,t=>{e($)&&t(Dr)})}var gt=u(pt,2);{var $r=t=>{var l=ra(),f=u(s(l),2),F=s(f,!0);n(f);var U=u(f,2);n(l),W(()=>P(F,e(w))),L("click",U,xe),D(t,l)};G(gt,t=>{e(w)&&t($r)})}var Mr=u(gt,2);{var Tr=t=>{var l=da(),f=Ze(l);{var F=C=>{var V=ia();Io(V,5,()=>e(v),Oo,(B,a)=>{var S=Ao(),q=Ze(S);{var Ot=ne=>{var se=sa(),Ce=s(se),ce=s(Ce),Pe=s(ce),je=s(Pe,!0);n(Pe),Do(2),n(ce),n(Ce);var Rt=u(Ce,2);{var Je=he=>{var pe=na(),Ye=s(pe),Ke=s(Ye),zr=s(Ke,!0);n(Ke);var It=u(Ke,2),Ut=s(It),qt=s(Ut),Br=s(qt,!0);n(qt),n(Ut),n(It),n(Ye);var Pr=u(Ye,2);{var jr=de=>{var ie=oa(),ke=s(ie),Yr=u(ke,2);n(ie),L("click",ke,()=>br({id:e(a).id,code:e(a).voucherCode||"",description:e(a).description||"",cta:e(a).cta||""})),L("click",Yr,()=>cr({id:e(a).id,code:e(a).voucherCode||"",description:e(a).description||"",cta:e(a).cta||""})),D(de,ie)},Jr=de=>{var ie=aa(),ke=s(ie);n(ie),L("click",ke,()=>vr({id:e(a).id,voucherCode:e(a).voucherCode||""})),D(de,ie)};G(Pr,de=>{e(a),z(()=>e(a).isCustom)?de(jr):de(Jr,!1)})}n(pe),W(()=>{P(zr,(e(a),z(()=>e(a).cta||"View Details"))),P(Br,(e(a),z(()=>e(a).description||"No description available")))}),D(he,pe)};G(Rt,he=>{e(a),z(()=>e(a).cta||!e(a).isCustom&&e(a).headline||e(a).description)&&he(Je)})}n(se),W((he,pe)=>{jt(se,1,`p-3 sm:p-4 rounded-lg border backdrop-blur-sm shadow-lg ${he??""}`),jt(ce,1,`w-full text-base sm:text-lg font-bold font-mono backdrop-blur-sm bg-white/90 px-3 py-2 rounded border border-white/40 break-all flex items-center justify-between hover:bg-white/95 transition-all cursor-pointer shadow-sm ${pe??""}`),P(je,(e(a),z(()=>e(a).voucherCode)))},[()=>(e(a),z(()=>"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("grabfood")||"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("grab")?"bg-green-200/60 border-green-400/70":"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("foodpanda")?"bg-pink-200/60 border-pink-400/70":"bg-gray-200/60 border-gray-400/70")),()=>(e(a),z(()=>"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("grabfood")||"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("grab")?"text-green-700":"merchantName"in e(a)&&e(a).merchantName?.toLowerCase().includes("foodpanda")?"text-pink-700":"text-gray-700"))],Kt),L("click",ce,()=>yr(e(a).voucherCode||"")),D(ne,se)};G(q,ne=>{e(a),z(()=>e(a).voucherCode)&&ne(Ot)})}D(B,S)}),n(V),D(C,V)},U=(C,V)=>{{var B=a=>{var S=la();D(a,S)};G(C,a=>{e(_)||a(B)},V)}};G(f,C=>{e(v),z(()=>e(v).length>0)?C(F):C(U,!1)})}var M=u(f,2);{var y=C=>{var V=ca();D(C,V)};G(M,C=>{e(_)&&C(y)})}D(t,l)};G(Mr,t=>{e(w)||t(Tr)})}n(ht),n(mt),n(Se);var _e=u(Se,2),bt=s(_e),Me=s(bt),Te=s(Me),Fr=s(Te);n(Te);var Lr=u(Te,2);n(Me);var Fe=u(Me,4),Le=s(Fe),xt=u(s(Le),2);Jt(xt),n(Le);var He=u(Le,2),Oe=u(s(He),2);W(()=>{e(te),Eo(()=>{})});var Re=s(Oe);Re.value=Re.__value="GrabFood";var _t=u(Re);_t.value=_t.__value="Foodpanda",n(Oe),n(He);var Ie=u(He,2),wt=u(s(Ie),2);Jt(wt),n(Ie);var Ue=u(Ie,2),yt=u(s(Ue),2);Fo(yt),n(Ue);var Ct=u(Ue,2),qe=s(Ct),Hr=s(qe);n(qe);var Or=u(qe,2);n(Ct),n(Fe),n(bt),n(_e),Ne(_e,t=>c(Q,t),()=>e(Q));var we=u(_e,2),kt=s(we),Ge=s(kt),Nt=u(s(Ge),2),Et=u(s(Nt),2),Rr=s(Et);n(Et),n(Nt),n(Ge);var Vt=u(Ge,2),St=s(Vt),Ir=u(St,2);n(Vt),n(kt),n(we),Ne(we,t=>c(ue,t),()=>e(ue));var ye=u(we,2),At=s(ye),ze=s(At),Dt=u(s(ze),2),$t=u(s(Dt),2),Ur=s($t);n($t),n(Dt),n(ze);var Mt=u(ze,2),Tt=s(Mt),qr=u(Tt,2);n(Mt),n(At),n(ye),Ne(ye,t=>c(ve,t),()=>e(ve));var Be=u(ye,2),Ft=s(Be),Lt=u(s(Ft),2),Ht=s(Lt),Gr=u(Ht,2);n(Lt),n(Ft),n(Be),Ne(Be,t=>c(fe,t),()=>e(fe)),W(()=>{P(kr,`${e(O)??""} Codes`),me.disabled=e(_),ft.disabled=e(_),P(Fr,`${e(R)?"Edit":"Add"} Custom Voucher`),P(Hr,`${e(R)?"Update":"Add"} Voucher`),P(Rr,`Are you sure you want to delete "${e(oe),z(()=>e(oe)?.code)??""}"? This action
          cannot be undone.`),P(Ur,`Are you sure you want to hide "${e(ae),z(()=>e(ae)?.voucherCode)??""}"? Hidden
          vouchers will reappear when you force refresh the page.`)}),L("click",ut,()=>{Ve(),e(Q).showModal()}),L("click",me,xe),L("click",ft,hr),L("click",Lr,()=>e(Q).close()),et(xt,()=>e(J),t=>c(J,t)),Bo(Oe,()=>e(te),t=>c(te,t)),et(wt,()=>e(X),t=>c(X,t)),et(yt,()=>e(K),t=>c(K,t)),L("click",Or,()=>e(Q).close()),L("submit",Fe,Yo(function(...t){(e(R)?ir:sr)?.apply(this,t)})),L("click",St,ur),L("click",Ir,dr),L("click",Tt,mr),L("click",qr,fr),L("click",Ht,gr),L("click",Gr,pr),D(r,it),No()}var fa=H('<meta name="description" content="Get the latest GrabFood vouchers. Save money on your food delivery orders with verified promo codes from restaurants across the Philippines."/>');function wa(r){Lo(o=>{var i=fa();$o.title="GrabFood Voucher Codes",D(o,i)}),va(r,{})}export{wa as component};
